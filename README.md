# ⚡ FastHorse

> SQL Server 脚本批量执行工具

FastHorse 是一款高效、易用的 SQL Server 脚本批量执行工具，专为数据库管理员和开发人员设计，让数据库脚本执行变得简单、快速、可靠！

![Version](https://img.shields.io/badge/version-1.0.0-blue.svg)
![.NET Framework](https://img.shields.io/badge/.NET%20Framework-4.7.2-purple.svg)
![License](https://img.shields.io/badge/license-MIT-green.svg)

## ✨ 主要特性

### 🚀 核心功能

- **批量执行 SQL 脚本**：一键执行文件夹中的所有 SQL 脚本文件
- **实时进度显示**：执行过程中实时显示进度和状态
- **详细执行日志**：记录每个脚本的执行时间、状态和错误信息
- **智能错误处理**：详细的错误信息展示，便于快速定位问题

### 🎨 用户界面

- **现代化设计**：简洁美观的用户界面，操作直观
- **流畅动画**：执行时显示奔跑的马动画，马的位置跟随进度条实时移动 🐎🏇
- **SQL 语法高亮**：支持 SQL 代码语法高亮显示，提升可读性
- **行号显示**：代码编辑器支持行号显示，与内容完美对齐
- **状态标识**：文件列表实时显示执行状态（成功/失败/执行中）
- **三向联动**：文件列表、执行记录、文件内容三者联动显示
- **性能优化**：防抖加载、异步渲染、双缓冲技术，流畅无卡顿

### ⚙️ 高级功能

- **自定义 SQL 选项**：支持设置 ANSI_NULLS、QUOTED_IDENTIFIER 等选项
- **数据库配置管理**：保存和管理数据库连接配置
- **执行详情查看**：点击查看每个脚本的详细执行信息
- **搜索和筛选**：支持按关键字搜索和按状态筛选执行记录
- **编码自动检测**：自动检测 SQL 文件编码（UTF-8、GBK 等）

## 📦 系统要求

- **操作系统**：Windows 7 / 8 / 10 / 11
- **.NET Framework**：4.7.2 或更高版本
- **数据库**：SQL Server 2008 或更高版本

## 🚀 快速开始

### 安装

1. 下载最新版本的 FastHorse
2. 解压到任意目录
3. 运行 `FastHorse.exe`

### 使用步骤

1. **配置数据库连接**
   - 点击 "⚙️ 数据库配置" 按钮
   - 输入服务器地址、数据库名称、用户名和密码
   - 点击 "测试连接" 确认连接成功
   - 保存配置

2. **选择 SQL 脚本文件夹**
   - 点击 "📁 选择文件夹" 按钮
   - 选择包含 SQL 脚本的文件夹
   - 工具会自动加载所有 .sql 文件

3. **配置 SQL 选项**（可选）
   - 点击 "⚙️ 查询选项" 按钮
   - 设置 ANSI_NULLS 和 QUOTED_IDENTIFIER 选项

4. **执行脚本**
   - 点击 "▶" 执行按钮
   - 等待执行完成
   - 查看执行结果和日志

## 📖 功能说明

### 文件列表

- 显示所有待执行的 SQL 脚本文件
- 双击文件可打开所在文件夹并定位到该文件
- 实时显示执行状态：
  - ✓ 绿色背景：执行成功
  - ✗ 红色背景：执行失败
  - ⏳ 蓝色背景：正在执行
- 点击文件可预览 SQL 脚本内容

### 文件内容预览

- **语法高亮**：SQL 关键字、函数、字符串等高亮显示
- **行号显示**：左侧显示行号，便于定位代码
- **只读模式**：防止误修改脚本内容

### 执行记录

- 显示每个脚本的执行详情：
  - 文件名称
  - 执行耗时
  - 执行状态
  - 错误信息（如果有）
- 支持按状态筛选（成功/失败/进行中）
- 支持关键字搜索
- 点击 "查看详情" 按钮查看完整的错误信息

### 执行详情弹窗

- 文件名称和路径
- 执行状态（成功/失败/执行中）
- 执行耗时
- 开始时间
- 详细错误信息（支持滚动查看）

## 🎨 界面截图

### 主界面
- 顶部工具栏：文件夹选择、数据库配置、查询选项、执行按钮
- 左侧：文件列表（带状态标识）
- 右上：SQL 脚本内容预览（带语法高亮和行号）
- 右下：执行记录和日志

### 配色方案
- 主题色：现代化蓝紫色系
- 成功状态：翠绿色
- 失败状态：红色
- 执行中：蓝色
- 背景：浅灰色层次分明

## 🛠️ 技术栈

- **开发语言**：C#
- **框架**：.NET Framework 4.7.2
- **UI 框架**：Windows Forms
- **数据库**：Microsoft.Data.SqlClient
- **SQL 管理**：Microsoft.SqlServer.SqlManagementObjects
- **编码检测**：Ude.NetStandard

## 📝 更新日志

### v1.0.0 (2025-12-24)

- ✨ 首次发布
- ✅ 批量执行 SQL 脚本
- ✅ 实时进度显示
- ✅ 详细执行日志
- ✅ SQL 语法高亮
- ✅ 行号显示
- ✅ 执行状态标识
- ✅ 三向联动显示
- ✅ 执行详情查看
- ✅ 搜索和筛选功能
- ✅ 数据库配置管理
- ✅ 自定义 SQL 选项

## ⚡ 性能优化

FastHorse 采用了多项性能优化技术，确保流畅的用户体验：

### 1. 防抖加载（Debounce Loading）
- 文件切换时使用 150ms 防抖延迟
- 避免快速切换时的重复加载
- 减少不必要的 I/O 操作

### 2. 异步文件加载
- 文件读取在后台线程执行
- UI 线程保持响应，不会卡顿
- 先显示纯文本，再异步应用语法高亮

### 3. 智能语法高亮
- 小文件（< 50KB）：完整语法高亮
- 大文件（50KB - 100KB）：快速高亮模式
- 超大文件（> 100KB）：简化高亮处理
- 后台线程处理，不阻塞 UI

### 4. 双缓冲渲染
- DataGridView 启用双缓冲
- 减少闪烁和重绘
- 提升滚动和选择的流畅度

### 5. 行号精确对齐
- 使用与编辑器相同的字体和渲染方式
- Graphics.MeasureString 精确计算行高
- ClearType 字体渲染，清晰美观

### 6. 马动画优化
- 4 帧流畅动画（🐴🏇🐎🏇）
- 马的位置跟随进度条实际进度
- 100ms 刷新间隔，流畅不卡顿
- 发光和阴影效果，视觉效果更佳

### 7. 事件优化
- 执行记录选择时临时禁用文件列表事件
- 避免重复触发和循环调用
- 减少不必要的数据绑定操作

## 🤝 贡献

欢迎提交 Issue 和 Pull Request！

## 📄 许可证

MIT License

## 👨‍💻 作者

**Call me**

## 🙏 致谢

感谢所有使用 FastHorse 的用户！

---

⚡ **FastHorse** - 让数据库脚本执行变得简单、快速、可靠！

